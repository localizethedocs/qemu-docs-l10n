<!DOCTYPE html>

<html lang="zh-TW" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>QEMU virtio-fs shared file system daemon &#8212; QEMU 5.1.0 說明文件</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=27fed22d" />
    <script src="../_static/documentation_options.js?v=9be52453"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/translations.js?v=cbf116e0"></script>
    <link rel="canonical" href="https://projects.localizethedocs.org/qemu-docs-l10n/tools/virtiofsd.html" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜尋" href="../search.html" />
    <link rel="next" title="QEMU System Emulation Management and Interoperability Guide" href="../interop/index.html" />
    <link rel="prev" title="QEMU 9p virtfs proxy filesystem helper" href="virtfs-proxy-helper.html" />

   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

<script type="text/javascript" src="../ltd-provenance.js"></script>
<script type="text/javascript" src="../ltd-current.js"></script>
<script type="text/javascript" src="../../../ltd-config.js"></script>
<script type="text/javascript" src="../../../ltd-flyout.js"></script>

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="qemu-virtio-fs-shared-file-system-daemon">
<h1>QEMU virtio-fs shared file system daemon<a class="headerlink" href="#qemu-virtio-fs-shared-file-system-daemon" title="連結到這個標頭">¶</a></h1>
<section id="synopsis">
<h2>Synopsis<a class="headerlink" href="#synopsis" title="連結到這個標頭">¶</a></h2>
<p><strong>virtiofsd</strong> [<em>OPTIONS</em>]</p>
</section>
<section id="description">
<h2>Description<a class="headerlink" href="#description" title="連結到這個標頭">¶</a></h2>
<p>Share a host directory tree with a guest through a virtio-fs device.  This
program is a vhost-user backend that implements the virtio-fs device.  Each
virtio-fs device instance requires its own virtiofsd process.</p>
<p>This program is designed to work with QEMU's <code class="docutils literal notranslate"><span class="pre">--device</span> <span class="pre">vhost-user-fs-pci</span></code>
but should work with any virtual machine monitor (VMM) that supports
vhost-user.  See the Examples section below.</p>
<p>This program must be run as the root user.  Upon startup the program will
switch into a new file system namespace with the shared directory tree as its
root.  This prevents &quot;file system escapes&quot; due to symlinks and other file
system objects that might lead to files outside the shared directory.  The
program also sandboxes itself using seccomp(2) to prevent ptrace(2) and other
vectors that could allow an attacker to compromise the system after gaining
control of the virtiofsd process.</p>
</section>
<section id="options">
<h2>Options<a class="headerlink" href="#options" title="連結到這個標頭">¶</a></h2>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-virtiofsd-h">
<span id="cmdoption-virtiofsd-help"></span><span class="sig-name descname"><span class="pre">-h</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--help</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-virtiofsd-h" title="連結到這個定義">¶</a></dt>
<dd><p>Print help.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-virtiofsd-V">
<span id="cmdoption-virtiofsd-version"></span><span class="sig-name descname"><span class="pre">-V</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--version</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-virtiofsd-V" title="連結到這個定義">¶</a></dt>
<dd><p>Print version.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-virtiofsd-d">
<span class="sig-name descname"><span class="pre">-d</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-virtiofsd-d" title="連結到這個定義">¶</a></dt>
<dd><p>Enable debug output.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-virtiofsd-syslog">
<span class="sig-name descname"><span class="pre">--syslog</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-virtiofsd-syslog" title="連結到這個定義">¶</a></dt>
<dd><p>Print log messages to syslog instead of stderr.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-virtiofsd-o">
<span class="sig-name descname"><span class="pre">-o</span></span><span class="sig-prename descclassname"> <span class="pre">OPTION</span></span><a class="headerlink" href="#cmdoption-virtiofsd-o" title="連結到這個定義">¶</a></dt>
<dd><ul class="simple">
<li><p>debug -
Enable debug output.</p></li>
<li><p>flock|no_flock -
Enable/disable flock.  The default is <code class="docutils literal notranslate"><span class="pre">no_flock</span></code>.</p></li>
<li><p>modcaps=CAPLIST
Modify the list of capabilities allowed; CAPLIST is a colon separated
list of capabilities, each preceded by either + or -, e.g.
''+sys_admin:-chown''.</p></li>
<li><p>log_level=LEVEL -
Print only log messages matching LEVEL or more severe.  LEVEL is one of
<code class="docutils literal notranslate"><span class="pre">err</span></code>, <code class="docutils literal notranslate"><span class="pre">warn</span></code>, <code class="docutils literal notranslate"><span class="pre">info</span></code>, or <code class="docutils literal notranslate"><span class="pre">debug</span></code>.  The default is <code class="docutils literal notranslate"><span class="pre">info</span></code>.</p></li>
<li><p>norace -
Disable racy fallback.  The default is false.</p></li>
<li><p>posix_lock|no_posix_lock -
Enable/disable remote POSIX locks.  The default is <code class="docutils literal notranslate"><span class="pre">posix_lock</span></code>.</p></li>
<li><p>readdirplus|no_readdirplus -
Enable/disable readdirplus.  The default is <code class="docutils literal notranslate"><span class="pre">readdirplus</span></code>.</p></li>
<li><p>source=PATH -
Share host directory tree located at PATH.  This option is required.</p></li>
<li><p>timeout=TIMEOUT -
I/O timeout in seconds.  The default depends on cache= option.</p></li>
<li><p>writeback|no_writeback -
Enable/disable writeback cache. The cache alows the FUSE client to buffer
and merge write requests.  The default is <code class="docutils literal notranslate"><span class="pre">no_writeback</span></code>.</p></li>
<li><p>xattr|no_xattr -
Enable/disable extended attributes (xattr) on files and directories.  The
default is <code class="docutils literal notranslate"><span class="pre">no_xattr</span></code>.</p></li>
</ul>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-virtiofsd-socket-path">
<span class="sig-name descname"><span class="pre">--socket-path</span></span><span class="sig-prename descclassname"><span class="pre">=PATH</span></span><a class="headerlink" href="#cmdoption-virtiofsd-socket-path" title="連結到這個定義">¶</a></dt>
<dd><p>Listen on vhost-user UNIX domain socket at PATH.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-virtiofsd-fd">
<span class="sig-name descname"><span class="pre">--fd</span></span><span class="sig-prename descclassname"><span class="pre">=FDNUM</span></span><a class="headerlink" href="#cmdoption-virtiofsd-fd" title="連結到這個定義">¶</a></dt>
<dd><p>Accept connections from vhost-user UNIX domain socket file descriptor FDNUM.
The file descriptor must already be listening for connections.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-virtiofsd-thread-pool-size">
<span class="sig-name descname"><span class="pre">--thread-pool-size</span></span><span class="sig-prename descclassname"><span class="pre">=NUM</span></span><a class="headerlink" href="#cmdoption-virtiofsd-thread-pool-size" title="連結到這個定義">¶</a></dt>
<dd><p>Restrict the number of worker threads per request queue to NUM.  The default
is 64.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-virtiofsd-cache">
<span class="sig-name descname"><span class="pre">--cache</span></span><span class="sig-prename descclassname"><span class="pre">=none|auto|always</span></span><a class="headerlink" href="#cmdoption-virtiofsd-cache" title="連結到這個定義">¶</a></dt>
<dd><p>Select the desired trade-off between coherency and performance.  <code class="docutils literal notranslate"><span class="pre">none</span></code>
forbids the FUSE client from caching to achieve best coherency at the cost of
performance.  <code class="docutils literal notranslate"><span class="pre">auto</span></code> acts similar to NFS with a 1 second metadata cache
timeout.  <code class="docutils literal notranslate"><span class="pre">always</span></code> sets a long cache lifetime at the expense of coherency.</p>
</dd></dl>

</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="連結到這個標頭">¶</a></h2>
<p>Export <code class="docutils literal notranslate"><span class="pre">/var/lib/fs/vm001/</span></code> on vhost-user UNIX domain socket
<code class="docutils literal notranslate"><span class="pre">/var/run/vm001-vhost-fs.sock</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">host</span><span class="c1"># virtiofsd --socket-path=/var/run/vm001-vhost-fs.sock -o source=/var/lib/fs/vm001</span>
<span class="n">host</span><span class="c1"># qemu-system-x86_64 \</span>
    <span class="o">-</span><span class="n">chardev</span> <span class="n">socket</span><span class="p">,</span><span class="nb">id</span><span class="o">=</span><span class="n">char0</span><span class="p">,</span><span class="n">path</span><span class="o">=/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">vm001</span><span class="o">-</span><span class="n">vhost</span><span class="o">-</span><span class="n">fs</span><span class="o">.</span><span class="n">sock</span> \
    <span class="o">-</span><span class="n">device</span> <span class="n">vhost</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="n">fs</span><span class="o">-</span><span class="n">pci</span><span class="p">,</span><span class="n">chardev</span><span class="o">=</span><span class="n">char0</span><span class="p">,</span><span class="n">tag</span><span class="o">=</span><span class="n">myfs</span> \
    <span class="o">-</span><span class="nb">object</span> <span class="n">memory</span><span class="o">-</span><span class="n">backend</span><span class="o">-</span><span class="n">memfd</span><span class="p">,</span><span class="nb">id</span><span class="o">=</span><span class="n">mem</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="n">G</span><span class="p">,</span><span class="n">share</span><span class="o">=</span><span class="n">on</span> \
    <span class="o">-</span><span class="n">numa</span> <span class="n">node</span><span class="p">,</span><span class="n">memdev</span><span class="o">=</span><span class="n">mem</span> \
    <span class="o">...</span>
<span class="n">guest</span><span class="c1"># mount -t virtiofs myfs /mnt</span>
</pre></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">QEMU</a></h1>








<h3>瀏覽</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../system/index.html">QEMU System Emulation User's Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/index.html">QEMU User Mode Emulation User's Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">QEMU Tools Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="qemu-img.html">QEMU disk image utility</a></li>
<li class="toctree-l2"><a class="reference internal" href="qemu-nbd.html">QEMU Disk Network Block Device Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="qemu-trace-stap.html">QEMU SystemTap trace tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="virtfs-proxy-helper.html">QEMU 9p virtfs proxy filesystem helper</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">QEMU virtio-fs shared file system daemon</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../interop/index.html">QEMU System Emulation Management and Interoperability Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../specs/index.html">QEMU System Emulation Guest Hardware Specifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devel/index.html">QEMU Developer's Guide</a></li>
</ul>


<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">快速搜尋</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="前往" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2020, The QEMU Project Developers.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.1.2</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
    </div>

    

    
  </body>
</html>