# SOME DESCRIPTIVE TITLE.
# Copyright (C) 2019, The QEMU Project Developers
# This file is distributed under the same license as the QEMU package.
# FIRST AUTHOR <EMAIL@ADDRESS>, YEAR.
#
#, fuzzy
msgid ""
msgstr ""
"Project-Id-Version: QEMU 4.2\n"
"Report-Msgid-Bugs-To: \n"
"POT-Creation-Date: 2025-10-28 10:00+0000\n"
"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
"Last-Translator: FULL NAME <EMAIL@ADDRESS>\n"
"Language-Team: LANGUAGE <LL@li.org>\n"
"Language: zh_CN\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"

#: ../../../interop/pr-helper.rst:5
msgid "Persistent reservation helper protocol"
msgstr ""

#: ../../../interop/pr-helper.rst:7
msgid ""
"QEMU's SCSI passthrough devices, ``scsi-block`` and ``scsi-generic``, can "
"delegate implementation of persistent reservations to an external (and "
"typically privileged) program.  Persistent Reservations allow restricting "
"access to block devices to specific initiators in a shared storage setup."
msgstr ""

#: ../../../interop/pr-helper.rst:13
msgid ""
"For a more detailed reference please refer to the SCSI Primary Commands "
"standard, specifically the section on Reservations and the \"PERSISTENT "
"RESERVE IN\" and \"PERSISTENT RESERVE OUT\" commands."
msgstr ""

#: ../../../interop/pr-helper.rst:17
msgid ""
"This document describes the socket protocol used between QEMU's ``pr-manager-"
"helper`` object and the external program."
msgstr ""

#: ../../../interop/pr-helper.rst:20
msgid "Contents"
msgstr ""

#: ../../../interop/pr-helper.rst:23
msgid "Connection and initialization"
msgstr ""

#: ../../../interop/pr-helper.rst:25
msgid "All data transmitted on the socket is big-endian."
msgstr ""

#: ../../../interop/pr-helper.rst:27
msgid ""
"After connecting to the helper program's socket, the helper starts a simple "
"feature negotiation process by writing four bytes corresponding to the "
"features it exposes (``supported_features``).  QEMU reads it, then writes "
"four bytes corresponding to the desired features of the helper program "
"(``requested_features``)."
msgstr ""

#: ../../../interop/pr-helper.rst:33
msgid ""
"If a bit is 1 in ``requested_features`` and 0 in ``supported_features``, the "
"corresponding feature is not supported by the helper and the connection is "
"closed.  On the other hand, it is acceptable for a bit to be 0 in "
"``requested_features`` and 1 in ``supported_features``; in this case, the "
"helper will not enable the feature."
msgstr ""

#: ../../../interop/pr-helper.rst:39
msgid ""
"Right now no feature is defined, so the two parties always write four zero "
"bytes."
msgstr ""

#: ../../../interop/pr-helper.rst:43
msgid "Command format"
msgstr ""

#: ../../../interop/pr-helper.rst:45
msgid ""
"It is invalid to send multiple commands concurrently on the same socket.  It "
"is however possible to connect multiple sockets to the helper and send "
"multiple commands to the helper for one or more file descriptors."
msgstr ""

#: ../../../interop/pr-helper.rst:50
msgid ""
"A command consists of a request and a response.  A request consists of a 16-"
"byte SCSI CDB.  A file descriptor must be passed to the helper together with "
"the SCSI CDB using ancillary data."
msgstr ""

#: ../../../interop/pr-helper.rst:54
msgid "The CDB has the following limitations:"
msgstr ""

#: ../../../interop/pr-helper.rst:56
msgid ""
"the command (stored in the first byte) must be one of 0x5E (PERSISTENT "
"RESERVE IN) or 0x5F (PERSISTENT RESERVE OUT)."
msgstr ""

#: ../../../interop/pr-helper.rst:59
msgid ""
"the allocation length (stored in bytes 7-8 of the CDB for PERSISTENT RESERVE "
"IN) or parameter list length (stored in bytes 5-8 of the CDB for PERSISTENT "
"RESERVE OUT) is limited to 8 KiB."
msgstr ""

#: ../../../interop/pr-helper.rst:63
msgid ""
"For PERSISTENT RESERVE OUT, the parameter list is sent right after the CDB.  "
"The length of the parameter list is taken from the CDB itself."
msgstr ""

#: ../../../interop/pr-helper.rst:66
msgid "The helper's reply has the following structure:"
msgstr ""

#: ../../../interop/pr-helper.rst:68
msgid "4 bytes for the SCSI status"
msgstr ""

#: ../../../interop/pr-helper.rst:70
msgid ""
"4 bytes for the payload size (nonzero only for PERSISTENT RESERVE IN and "
"only if the SCSI status is 0x00, i.e. GOOD)"
msgstr ""

#: ../../../interop/pr-helper.rst:73
msgid "96 bytes for the SCSI sense data"
msgstr ""

#: ../../../interop/pr-helper.rst:75
msgid "if the size is nonzero, the payload follows"
msgstr ""

#: ../../../interop/pr-helper.rst:77
msgid ""
"The sense data is always sent to keep the protocol simple, even though it is "
"only valid if the SCSI status is CHECK CONDITION (0x02)."
msgstr ""

#: ../../../interop/pr-helper.rst:80
msgid ""
"The payload size is always less than or equal to the allocation length "
"specified in the CDB for the PERSISTENT RESERVE IN command."
msgstr ""

#: ../../../interop/pr-helper.rst:83
msgid "If the protocol is violated, the helper closes the socket."
msgstr ""
