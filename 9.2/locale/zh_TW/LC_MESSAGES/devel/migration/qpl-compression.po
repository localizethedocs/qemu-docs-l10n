# SOME DESCRIPTIVE TITLE.
# Copyright (C) 2024, The QEMU Project Developers
# This file is distributed under the same license as the QEMU package.
# FIRST AUTHOR <EMAIL@ADDRESS>, YEAR.
#
#, fuzzy
msgid ""
msgstr ""
"Project-Id-Version: QEMU 9.2\n"
"Report-Msgid-Bugs-To: \n"
"POT-Creation-Date: 2025-10-28 10:00+0000\n"
"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
"Last-Translator: FULL NAME <EMAIL@ADDRESS>\n"
"Language-Team: LANGUAGE <LL@li.org>\n"
"Language: zh_TW\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"

#: ../../../devel/migration/qpl-compression.rst:3
msgid "QPL Compression"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:4
msgid ""
"The Intel Query Processing Library (Intel ``QPL``) is an open-source library "
"to provide compression and decompression features and it is based on deflate "
"compression algorithm (RFC 1951)."
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:8
msgid ""
"The ``QPL`` compression relies on Intel In-Memory Analytics "
"Accelerator(``IAA``) and Shared Virtual Memory(``SVM``) technology, they are "
"new features supported from Intel 4th Gen Intel Xeon Scalable processors, "
"codenamed Sapphire Rapids processor(``SPR``)."
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:13
msgid ""
"For more ``QPL`` introduction, please refer to `QPL Introduction <https://"
"intel.github.io/qpl/documentation/introduction_docs/introduction.html>`_"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:17
msgid "QPL Compression Framework"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:21
msgid ""
"+----------------+       +------------------+\n"
"| MultiFD Thread |       |accel-config tool |\n"
"+-------+--------+       +--------+---------+\n"
"        |                         |\n"
"        |                         |\n"
"        |compress/decompress      |\n"
"+-------+--------+                | Setup IAA\n"
"|  QPL library   |                | Resources\n"
"+-------+---+----+                |\n"
"        |   |                     |\n"
"        |   +-------------+-------+\n"
"        |   Open IAA      |\n"
"        |   Devices +-----+-----+\n"
"        |           |idxd driver|\n"
"        |           +-----+-----+\n"
"        |                 |\n"
"        |                 |\n"
"        |           +-----+-----+\n"
"        +-----------+IAA Devices|\n"
"    Submit jobs     +-----------+\n"
"    via enqcmd"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:45
msgid "QPL Build And Installation"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:47
msgid ""
"$git clone --recursive https://github.com/intel/qpl.git qpl\n"
"$mkdir qpl/build\n"
"$cd qpl/build\n"
"$cmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=/usr -"
"DQPL_LIBRARY_TYPE=SHARED ..\n"
"$sudo cmake --build . --target install"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:55
msgid ""
"For more details about ``QPL`` installation, please refer to `QPL "
"Installation <https://intel.github.io/qpl/documentation/get_started_docs/"
"installation.html>`_"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:59
msgid "IAA Device Management"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:61
msgid ""
"The number of ``IAA`` devices will vary depending on the Xeon product model. "
"On a ``SPR`` server, there can be a maximum of 8 ``IAA`` devices, with up to "
"4 devices per socket."
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:65
msgid ""
"By default, all ``IAA`` devices are disabled and need to be configured and "
"enabled by users manually."
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:68
msgid "Check the number of devices through the following command"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:70
msgid ""
"#lspci -d 8086:0cfe\n"
"6a:02.0 System peripheral: Intel Corporation Device 0cfe\n"
"6f:02.0 System peripheral: Intel Corporation Device 0cfe\n"
"74:02.0 System peripheral: Intel Corporation Device 0cfe\n"
"79:02.0 System peripheral: Intel Corporation Device 0cfe\n"
"e7:02.0 System peripheral: Intel Corporation Device 0cfe\n"
"ec:02.0 System peripheral: Intel Corporation Device 0cfe\n"
"f1:02.0 System peripheral: Intel Corporation Device 0cfe\n"
"f6:02.0 System peripheral: Intel Corporation Device 0cfe"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:83
msgid "IAA Device Configuration And Enabling"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:85
msgid ""
"The ``accel-config`` tool is used to enable ``IAA`` devices and configure "
"``IAA`` hardware resources(work queues and engines). One ``IAA`` device has "
"8 work queues and 8 processing engines, multiple engines can be assigned to "
"a work queue via ``group`` attribute."
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:90
msgid ""
"For ``accel-config`` installation, please refer to `accel-config "
"installation <https://github.com/intel/idxd-config>`_"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:93
msgid "One example of configuring and enabling an ``IAA`` device."
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:95
msgid ""
"#accel-config config-engine iax1/engine1.0 -g 0\n"
"#accel-config config-engine iax1/engine1.1 -g 0\n"
"#accel-config config-engine iax1/engine1.2 -g 0\n"
"#accel-config config-engine iax1/engine1.3 -g 0\n"
"#accel-config config-engine iax1/engine1.4 -g 0\n"
"#accel-config config-engine iax1/engine1.5 -g 0\n"
"#accel-config config-engine iax1/engine1.6 -g 0\n"
"#accel-config config-engine iax1/engine1.7 -g 0\n"
"#accel-config config-wq iax1/wq1.0 -g 0 -s 128 -p 10 -b 1 -t 128 -m shared -"
"y user -n app1 -d user\n"
"#accel-config enable-device iax1\n"
"#accel-config enable-wq iax1/wq1.0"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:110
msgid "IAX is an early name for IAA"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:112
msgid ""
"The ``IAA`` device index is 1, use ``ls -lh /sys/bus/dsa/devices/iax*`` "
"command to query the ``IAA`` device index."
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:115
msgid ""
"8 engines and 1 work queue are configured in group 0, so all compression "
"jobs submitted to this work queue can be processed by all engines at the "
"same time."
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:118
msgid ""
"Set work queue attributes including the work mode, work queue size and so on."
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:120
msgid "Enable the ``IAA1`` device and work queue 1.0"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:124
msgid ""
"Set work queue mode to shared mode, since ``QPL`` library only supports "
"shared mode"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:127
msgid ""
"For more detailed configuration, please refer to `IAA Configuration Samples "
"<https://github.com/intel/idxd-config/tree/stable/Documentation/accfg>`_"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:131
msgid "IAA Unit Test"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:133
msgid ""
"Enabling ``IAA`` devices for Xeon platform, please refer to `IAA User Guide "
"<https://www.intel.com/content/www/us/en/content-details/780887/intel-in-"
"memory-analytics-accelerator-intel-iaa.html>`_"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:136
msgid ""
"``IAA`` device driver is Intel Data Accelerator Driver (idxd), it is "
"recommended that the minimum version of Linux kernel is 5.18."
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:139
msgid ""
"Add ``\"intel_iommu=on,sm_on\"`` parameter to kernel command line for "
"``SVM`` feature enabling."
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:142
msgid ""
"Here is an easy way to verify ``IAA`` device driver and ``SVM`` with "
"`iaa_test <https://github.com/intel/idxd-config/tree/stable/test>`_"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:145
msgid ""
"#./test/iaa_test\n"
" [ info] alloc wq 0 shared size 128 addr 0x7f26cebe5000 batch sz 0xfffffffe "
"xfer sz 0x80000000\n"
" [ info] test noop: tflags 0x1 num_desc 1\n"
" [ info] preparing descriptor for noop\n"
" [ info] Submitted all noop jobs\n"
" [ info] verifying task result for 0x16f7e20\n"
" [ info] test with op 0 passed"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:157
msgid "IAA Resources Allocation For Migration"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:159
msgid ""
"There is no ``IAA`` resource configuration parameters for migration and "
"``accel-config`` tool configuration cannot directly specify the ``IAA`` "
"resources used for migration."
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:163
msgid ""
"The multifd migration with ``QPL`` compression method  will use all work "
"queues that are enabled and shared mode."
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:168
msgid ""
"Accessing IAA resources requires ``sudo`` command or ``root`` privileges by "
"default. Administrators can modify the IAA device node ownership so that "
"QEMU can use IAA with specified user permissions."
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:172
msgid "For example"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:174
msgid "#chown -R qemu /dev/iax"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:177
msgid "Shared Virtual Memory(SVM) Introduction"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:179
msgid ""
"An ability for an accelerator I/O device to operate in the same virtual "
"memory space of applications on host processors. It also implies the ability "
"to operate from pageable memory, avoiding functional requirements to pin "
"memory for DMA operations."
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:184
msgid ""
"When using ``SVM`` technology, users do not need to reserve memory for the "
"``IAA`` device and perform pin memory operation. The ``IAA`` device can "
"directly access data using the virtual address of the process."
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:188
msgid ""
"For more ``SVM`` technology, please refer to `Shared Virtual Addressing "
"(SVA) with ENQCMD <https://docs.kernel.org/next/x86/sva.html>`_"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:194
msgid "How To Use QPL Compression In Migration"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:196
msgid ""
"1 - Installation of ``QPL`` library and ``accel-config`` library if using IAA"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:198
msgid ""
"2 - Configure and enable ``IAA`` devices and work queues via ``accel-config``"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:200
msgid "3 - Build ``QEMU`` with ``--enable-qpl`` parameter"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:202
msgid ""
"E.g. configure --target-list=x86_64-softmmu --enable-kvm ``--enable-qpl``"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:204
msgid "4 - Enable ``QPL`` compression during migration"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:206
msgid ""
"Set ``migrate_set_parameter multifd-compression qpl`` when migrating, the "
"``QPL`` compression does not support configuring the compression level, it "
"only supports one compression level."
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:211
msgid "The Difference Between QPL And ZLIB"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:213
msgid ""
"Although both ``QPL`` and ``ZLIB`` are based on the deflate compression "
"algorithm, and ``QPL`` can support the header and tail of ``ZLIB``, ``QPL`` "
"is still not fully compatible with the ``ZLIB`` compression in the migration."
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:217
msgid ""
"``QPL`` only supports 4K history buffer, and ``ZLIB`` is 32K by default. "
"``ZLIB`` compresses data that ``QPL`` may not decompress correctly and vice "
"versa."
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:221
msgid ""
"``QPL`` does not support the ``Z_SYNC_FLUSH`` operation in ``ZLIB`` "
"streaming compression, current ``ZLIB`` implementation uses "
"``Z_SYNC_FLUSH``, so each ``multifd`` thread has a ``ZLIB`` streaming "
"context, and all page compression and decompression are based on this "
"stream. ``QPL`` cannot decompress such data and vice versa."
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:227
msgid ""
"The introduction for ``Z_SYNC_FLUSH``, please refer to `Zlib Manual <https://"
"www.zlib.net/manual.html>`_"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:231
msgid "The Best Practices"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:232
msgid ""
"When user enables the IAA device for ``QPL`` compression, it is recommended "
"to add ``-mem-prealloc`` parameter to the destination boot parameters. This "
"parameter can avoid the occurrence of I/O page fault and reduce the overhead "
"of IAA compression and decompression."
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:237
msgid "The example of booting with ``-mem-prealloc`` parameter"
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:239
msgid "$qemu-system-x86_64 --enable-kvm -cpu host --mem-prealloc ..."
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:244
msgid ""
"An example about I/O page fault measurement of destination without ``-mem-"
"prealloc``, the ``svm_prq`` indicates the number of I/O page fault "
"occurrences and processing time."
msgstr ""

#: ../../../devel/migration/qpl-compression.rst:248
msgid ""
"#echo 1 > /sys/kernel/debug/iommu/intel/dmar_perf_latency\n"
"#echo 2 > /sys/kernel/debug/iommu/intel/dmar_perf_latency\n"
"#echo 3 > /sys/kernel/debug/iommu/intel/dmar_perf_latency\n"
"#echo 4 > /sys/kernel/debug/iommu/intel/dmar_perf_latency\n"
"#cat /sys/kernel/debug/iommu/intel/dmar_perf_latency\n"
"IOMMU: dmar18 Register Base Address: c87fc000\n"
"                <0.1us   0.1us-1us    1us-10us  10us-100us   100us-1ms    "
"1ms-10ms      >=10ms     min(us)     max(us) average(us)\n"
" inv_iotlb           0         286         123           0           "
"0           0           0           0           1           0\n"
"inv_devtlb           0         276         133           0           "
"0           0           0           0           2           0\n"
"   inv_iec           0           0           0           0           "
"0           0           0           0           0           0\n"
"   svm_prq           0           0       25206         364         "
"395           0           0           1         556           9"
msgstr ""
